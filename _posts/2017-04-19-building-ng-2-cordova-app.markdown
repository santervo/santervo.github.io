---
layout: post
title:  "Building Angular 2 based Cordova App"
date:   2017-04-19 09:50:00 +0300
---
In this blog post I'm going to experiment building a hybrid mobile application
using  [Angular 2][angular-2] and [Cordova][cordova].

Let's start of by installing cordova and creating new cordova app

{% highlight bash %}
$ npm install -g cordova
$ cordova create ng-cordova-demo io.github.santervo.ngcordovademo ngCordovaDemo
{% endhighlight %}

This will a bare bones cordova application in <code>ng&#8209;cordova&#8209;demo</code> directory.
Inside the directory you will find `config.xml`, Cordova main configuration file and few directories.
Directory `www` contains the actual javascript application, `index.html` being the entry point for the
application.

To be able to build for mobile device we need to add a platform to cordova application. In my case
I'm going to add android platform:

{% highlight bash %}
$ cordova platform add android
{% endhighlight %}

Next we'll generate a new Angular 2 application *over* the cordova application just created:

{% highlight bash %}
$ npm install -g @angular/cli
$ ng new ng-cordova-demo
{% endhighlight %}

This will setup tooling via npm and generate a skeleton Angular application inside `src` directory.
Development server can be started with `npm start`. 

Next step is to make Angular and Cordova work together. By default Angular cli builds the app into
`dist` directory. What we'll want is change the build directory to `www` which is the content directory
for cordova.

First thing to do is to remove the initial contents generated by cordova
with <code style="white-space: nowrap;">rm -r www/*</code>. 

Then we need to modify the package.json and set build command to target the www directory.

{% highlight javascript %}
"build": "ng build --output-path www"
{% endhighlight %}

Before building we need to make one small change to the sources, and remove base tag from
<code style="white-space: nowrap;">src/index.html</code>.
This will ensure that the javascript and css files are loaded relative to the index.html location.

{% highlight html %}
<base href="/"> <!-- remove this line -->
{% endhighlight %}


Now we are ready to build the app and run it in device.

{% highlight bash %}
$ npm run build
$ cordova run android --device
{% endhighlight %}

That's it! 

[angular-2]: https://angular.io
[angular-cli]: https://github.com/angular/angular-cli
[cordova]: https://cordova.apache.org/
